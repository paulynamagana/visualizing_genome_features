---
title: "Visualizing_genome"
author: "Paulyna Magana"
date: "19/05/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache=TRUE, echo = TRUE)
```

# Libraries

```{r, message=FALSE, warning=FALSE}
library(Gviz)
library(rtracklayer)
library(GenomicRanges)
library(biomaRt)
```

```{r tracknames, warning=FALSE}

session <- browserSession()
genome(session) <- "hg38"
trackNames(session)

```

```{r example, warning=FALSE, cache=TRUE, fig.width=8, fig.height=4}
gtrack <- GenomeAxisTrack() #to add a genomic axis to the plot
ideoTrack <- IdeogramTrack(genome = "hg38", chromosome = "chr6")# ideogram

#plot
# showbandId - chromosome bands in the ideogram
# turn off the explicit plotting of the chromosome name by setting the showId display parameter to FALSE.
plotTracks(ideoTrack, from = 85e6, to = 129e6, showId = FALSE, 
           showBandId = TRUE, cex.bands = 0.5)
```

```{r SLC22A1, warning=FALSE, cache=TRUE, fig.width=8, fig.height=4}

###Simple annotation tracks:
from <- 160115734
to <- 160160664



##Gene model type tracks:

ncbi_ref <- UcscTrack(genome="hg38", chromosome="chr6", track="NCBI RefSeq", 
                    from=from, to=to, trackType="GeneRegionTrack", 
                    rstarts="exonStarts", rends="exonEnds", gene="name", 
                    symbol="name", transcript="name", strand="strand", 
                    fill="#767676",stacking="squish", name="NCBI RefSeq", 
                    showId=TRUE, geneSymbol=TRUE)


biomTrack <- BiomartGeneRegionTrack(genome="hg38", chromosome="chr6",
                                    start=from, end=to, name="Ensembl")


###Data tracks



###Other tracks and plotting: 

axTrack <- GenomeAxisTrack()
idxTrack <- IdeogramTrack(genome="hg38", chromosome="chr6")

##PLOTTING
plotTracks(list(idxTrack, axTrack, ncbi_ref), from=from, to=to, showTitle=TRUE, col.line=NULL,
           collapseTranscripts="longest", transcriptAnnotation = "symbol")


```


```{r SLC22A1 high, warning=FALSE, cache=TRUE, fig.width=8, fig.height=4}
ht <- HighlightTrack(trackList = list(axTrack, ncbi_ref),
                     start = c(160136234, 160136250), width = 7,
                     chromosome = 6)

lim <- c(from, to)

plotTracks(list(idxTrack, ht), from = lim[1], to = lim[2])


```

### SLC22A5

```{r SLC22A5, warning=FALSE, cache=TRUE, fig.width=12, fig.height=4}

###Simple annotation tracks:
from <- 132366800
to <- 132396017


##Gene model type tracks:

ncbi_ref <- UcscTrack(genome="hg38", chromosome="chr5", track="NCBI RefSeq", 
                    from=from, to=to, trackType="GeneRegionTrack", 
                    rstarts="exonStarts", rends="exonEnds", gene="name", 
                    symbol="name", transcript="name", strand="strand", 
                    fill="#767676",stacking="squish", name="NCBI RefSeq", 
                    showId=TRUE, geneSymbol=TRUE)


biomTrack <- BiomartGeneRegionTrack(genome="hg38", chromosome="chr5",
                                    start=from, end=to, name="Ensembl")


###Data tracks



###Other tracks and plotting: 

axTrack <- GenomeAxisTrack()
idxTrack <- IdeogramTrack(genome="hg38", chromosome="chr5")

##PLOTTING
plotTracks(list(idxTrack, axTrack, ncbi_ref), from=from, to=to, showTitle=TRUE, col.line=NULL,
           collapseTranscripts="longest", transcriptAnnotation = "symbol")

```

```{r SLC22A5 high, warning=FALSE, cache=TRUE, fig.width=12, fig.height=4}
ht <- HighlightTrack(trackList = list(axTrack, ncbi_ref),
                     start = c(132384160, 132384180), width = 7,
                     chromosome = 5)

lim <- c(from, to)

plotTracks(list(idxTrack, ht), from = lim[1], to = lim[2])


```


### SLC22A4

```{r SLC22A4, warning=FALSE, cache=TRUE, fig.width=14, fig.height=4}

###Simple annotation tracks:
from <- 132290928
to <- 132345343


##Gene model type tracks:

ncbi_ref <- UcscTrack(genome="hg38", chromosome="chr5", track="NCBI RefSeq", 
                    from=from, to=to, trackType="GeneRegionTrack", 
                    rstarts="exonStarts", rends="exonEnds", gene="name", 
                    symbol="name", transcript="name", strand="strand", 
                    fill="#767676",stacking="squish", name="NCBI RefSeq", 
                    showId=TRUE, geneSymbol=TRUE)


biomTrack <- BiomartGeneRegionTrack(genome="hg38", chromosome="chr5",
                                    start=from, end=to, name="Ensembl")


###Data tracks



###Other tracks and plotting: 

axTrack <- GenomeAxisTrack()
idxTrack <- IdeogramTrack(genome="hg38", chromosome="chr5")

##PLOTTING
plotTracks(list(idxTrack, axTrack, ncbi_ref), from=from, to=to, showTitle=TRUE, col.line=NULL,
           collapseTranscripts="longest", transcriptAnnotation = "symbol")

```

```{r SLC22A4 high, warning=FALSE, cache=TRUE, fig.width=16, fig.height=4}

ht <- HighlightTrack(trackList = list(axTrack, ncbi_ref),
                     start = c(132313626, 132313650), width = 7,
                     chromosome = 5)

lim <- c(from, to)

plotTracks(list(idxTrack, ht), from = lim[1], to = lim[2])


```



## R Markdown

```{r sessioninfo, echo=FALSE}
sessionInfo()
```
